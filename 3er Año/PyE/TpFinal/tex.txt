\documentclass{report}
\usepackage{amsmath}
\usepackage[utf8]{inputenc}
\usepackage{vmargin}
\usepackage{graphicx}

\usepackage{etoolbox}

\graphicspath{ {images/} }
\setpapersize{A4}
\setmargins{2.5cm}       % margen izquierdo
{1.5cm}                        % margen superior
{16.5cm}                      % anchura del texto
{23.42cm}                    % altura del texto
{10pt}                           % altura de los encabezados
{1cm}                           % espacio entre el texto y los encabezados
{0pt}                             % altura del pie de página
{2cm}           
\begin{document}

\begin{titlepage}
\centering
{\bfseries\LARGE Universidad Nacional de Rosario \par}
\vspace{0,5cm}
{\scshape\Large Facultad de Ciencias Exactas, Ingeniería y Agrimensura \par}
\vspace{2cm}
{\scshape\Huge Probabilidad y Estadística\par}
\vspace{3cm}
{\itshape\Huge Tp final \par}
\vfill
{\Large Autor:\par}
\vspace{1 cm}
{\Large Demagistris, Santiago Ignacio \par}
\vfill
{\Large Agosto 2020 \par}
\end{titlepage}
\newpage

\section{Ejercicio 1}
\vspace{0,5cm}

\begin{itemize}
    \item [a)] El espacio muestral sobre el cual estamos trabajando es S=\{0,1\}, donde cara es 1 y cruz es 0. $I_n$ y $S_n$ 
    
    \vspace{0,5cm}
    {n = 100 # Cantidad de tiradas\\
    
    simulacion = simular(n)\\\\
    
    
    simular $<-$ function(n)\{\\
    
      In $<-$ tirarMoneda(n) (n tiradas de una moneda)\\
      Xn $<-$ cumsum(In) (numero de caras al momento n - Frecuencia relativa acumulada -)\\
      vectorTiradas $<-$ c(1:n)\\
      return (data.frame(Xn,vectorTiradas)) 
    \}\\\\
    
    tirarMoneda$<-$function(n)\{ (Tirar moneda n veces)\\
    
      return(sample(0:1,100,replace = TRUE))  (Vector de longitud n donde cada posicion tiene 1 o 0)
    \}
}
    
    
    
\end{itemize}
\begin{figure}[htb]
        \centering
        \includegraphics{ncmn.png}
        \caption{Tiradas de moneda}
        \label{fig:my_label}
    \end{figure}
\vspace{0,5cm}
{Sea A=\{"Obtener cara al lanzar la moneda"\}. Podemos observar que se obtuvo un total de 54 caras en este proceso, por lo tanto P(A) $\simeq\frac{54}{100}=0.54=p$ }
{}
\vspace{0,5cm}

\begin{itemize}
    \item [b)] 
    \item []  ({\bf P(X=1)}).{ Sabemos que X=\{"Número de veces que ocurrió el evento A "\} y que $X\sim Bi(n,0.54)$ (siendo p =0.54 observado en la simulacion). Por lo tanto $P(X=1) ={n \choose 1} (0.54)(0.46)^{n-1}$ y $E(X)=n0.54$. }
    \vspace{0,5cm}
    

    \item [c)] {Sea Y= Número de tiradas hasta que salgan 3 caras. $Y\sim Pascal$, por lo que \[P(Y=k)={{k-1}\choose{3-1}} 0.54^3 \  0.46^{k-3}={{k-1}\choose{2}} 0.54^3 \ 0.46^{k-3}\] y E(Y) = $\frac{r}{p}= \frac{3}{0.54}\simeq 5.55$. Es decir que se espera que entre la 5ta y la 6ta tirada de la moneda obtengamos 3 caras.}
\end{itemize}
\begin{itemize}
    \item [d)] La implementacion que utilice para sesgar la moneda es la siguiente:\\
    
    tirarMonedaSesgada $<-$ function(n)\{\\
    
      return (sample(0:2,100,  replace =TRUE)\%\%2)
    \}\\
    
    {De esta manera trabajo sobre un espacio muestral $S_x\{0,1,2\}$, donde A=\{1\}=\{"Obtuve cara"\} y$A^c$=\{"Obtuve Cruz"\}} 
    
    \begin{figure}[htb]
        \centering
        \includegraphics{simulacionD.png}
        \caption{Tiradas de moneda sesgada}
        \label{fig:my_label}
    \end{figure}

    
  {Al simular el proceso con n=100 obtuve que salieron en total 24 caras, por lo tanto podria aproximar $P(A)\simeq 0,24$. Por lo tanto $P(X=1) ={n \choose 1} (0.24)(0.76)^{n-1}$ y $E(X)=n0.24$}
\end{itemize}
\newpage

\section{Ejercicio 2}
\vspace{0,5cm}

{Para simular la situacion implemente lo siguiente: 
\vspace{1cm}

simular$<-$function(n)\{
\vspace{0,5cm}

  In $<-$ tirarMoneda(n) -- Tiro n veces la moneda
  \vspace{0,5cm}
  
  Tiradas $<-$ c(1:n)    --  Genero el eje X
  \vspace{0,5cm}
  
  Dn = variableAleatoria(In) -- Obtengo la variable aleatoria Dn apartir de In
  \vspace{0,5cm}
  
  Xn = cumsum(Dn)  -- Obtengo el desplazamiento como la frecuencia relativa acumulada de Dn
  \vspace{0,5cm}
  
  proceso1 $<-$ data.frame(In,Tiradas)
  \vspace{0,5cm}
  
  proceso2 $<-$ data.frame(Dn,Tiradas)
  \vspace{0,5cm}
  
  
  $mi_df <- data.frame$(
    "Proceso1" = In,
    "Proceso2" = Xn
  )
  \vspace{0,5cm}
  
 $ return (mi_df)$
  \vspace{0,5cm}
  
\}
\vspace{1cm}

tirarMoneda$<-$function(n)\{ -- Tirar moneda n veces
\vspace{1cm}
  
  return(sample(0:1,n,replace = TRUE))
  \vspace{0,5cm}
  
\}
\vspace{1cm}

variableAleatoria$<-$ function(In)\{  -- Obtengo Dn
\vspace{1cm}
  
  Dn $<-$ c()
  \vspace{0,5cm}
  
  for (i in In)\{
  \vspace{0,5cm}
  
    Dn $<-$ c(Dn,(2 * i) - 1)
    \vspace{0,5cm}
    
  \}
  \vspace{0,5cm}
  
  return (Dn)
  \vspace{0,5cm}
  
\}
}

\begin{figure}[htb]
        \centering
        \includegraphics{ej2/mpd.png}
        \label{fig:my_label}
    \end{figure}
\vspace{0,5cm}
\begin{center}
    {\bf Tabla de frencuencias}
\end{center}

\begin{figure}[htb]
        \centering
        \includegraphics{ej2/tabla2.png}
        \label{fig:my_label}
    \end{figure}
\vspace{1cm}
    
{La trayectoria descripta por Xn es causa del lanzamiento de la moneda (10 veces en este caso). Cada vez que salga cara en la moneda el sujeto se desplazara 1 unidad en el espacio y cuando salga cruz un 0. (Cara representado con 1 y cruz representado con 0). La decision de desplazamiento esta dada por Dn, mientras que Xn solo describe la trayectoria, es decir la frecuencia acumulada de los resultados obtenidos.}


\newpage

\section{Ejercicio 3}
\vspace{1cm}
\begin{itemize}
    \item [a)] En R implemente lo siguiente para simular el proceso:
    \vspace{1cm}
    
    proceso $<-$function(plataInicial,S,p)\{
    \vspace{1cm}
    
  limiteInferior = 0
  \vspace{0,5cm}
  
  limiteSuperior = S
  \vspace{0,5cm}
  
  plataActual = plataInicial
  \vspace{0,5cm}
  
  ganar = p
  \vspace{0,5cm}
  
  perder = 1-ganar
  \vspace{0,5cm}
  
  vectorProbabilidad = c(ganar,perder)
  \vspace{0,5cm}
  
  trayectoria = c(plataInicial)
  \vspace{0,5cm}
  
  termino = FALSE
  \vspace{0,5cm}
  
  
  
  while (!termino) \{
  \vspace{0,5cm}
  
    if(tirada(vectorProbabilidad) == ganar)\{
    \vspace{0,5cm}
      
      plataActual = plataActual + 1
    \}
    \vspace{0,5cm}
    
    else\{
    \vspace{0,5cm}
    
      plataActual = plataActual - 1
    \}
    \vspace{0,5cm}
    
    trayectoria = c(trayectoria,plataActual)
    \vspace{0,5cm}
    
    if(plataActual == limiteSuperior)\{termino = TRUE\}
    \vspace{0,5cm}
    
    if(plataActual == limiteInferior)\{termino = TRUE\}
    \vspace{0,5cm}
    
  \}
  \vspace{0,3cm}
  
  return (trayectoria[length(trayectoria)] == S)
 
\}
\newpage

\vspace{5cm}

tirada$<-$function(probabilidades)\{
\vspace{1cm}

  probabilidades = sort(probabilidades)
  \vspace{0,5cm}
  
  intervaloAleatorio = 1000000 -- Probabilidades de hasta 6 digitos despues del .
  \vspace{0,5cm}
  
  tirada = sample(1:intervaloAleatorio,1)
  \vspace{0,5cm}
  
  posicion = 1
  \vspace{0,5cm}
  
  for (i in probabilidades)\{
  \vspace{0,3cm}
  
    if (posicion == length(probabilidades))\{
    \vspace{0,3cm}
    
      return (i)
    \}
    if(tirada <= i*1000000)\{
    \vspace{0,3cm}
    
      return (i) # Devuelvo la probabilidad que ocurrio
    \}
    \vspace{0,3cm}
    
    posicion = posicion +1
    \vspace{0,3cm}
    
  \}
\}
\end{itemize}


\begin{itemize}
    \item [b)]Para realizar la simulacion usare k=50, p=0.55, S=100, perder=0. El resultado obtenido fue el siguiente:
    
    \begin{figure}[htb]
        \centering
        \includegraphics{rddj.png}
        \caption{Trayectoria. Ruina del jugador}
        \label{fig:my_label}
\end{figure}
\end{itemize}
    

\vspace{0,3cm}


    
\vspace{0,3cm}
\begin{itemize}
\vspace{0,3cm}
    \item [c)] Para simular esto, implemente en R:
    \vspace{0,5cm}
    probabilidadRuina $<-$ function(plataInicial,S,p,n)\{
  \vspace{1cm}

  frecRuina = 0
  \vspace{0,5cm}
  
  for (i in c(1:n))\{
  \vspace{0,5cm}
  
    if(!proceso(plataInicial,S,p))\{
    \vspace{0,5cm}
    
      frecRuina = frecRuina+1
      \vspace{0,5cm}
      
    \}
  \}
  return (frecRuina/n)
  \vspace{0,5cm}
  
\}
    
\vspace{1cm}
    
    
    Con k=20, S=60, p=0.5001 y 1000 trayectorias obtuve una aproximacion a la probabilidad de caer en la ruina de 0.678
\end{itemize}
\newpage


\section{Ejercicio 4}
\vspace{0,5cm}

\begin{itemize}
    \item [a)] Al realizar la simulacion observe 50000 repeticiones del experimento y obtuve un promedio de 21.08484 minutos.
    \item [b)] Sea S=\{ii,id,d\} el espacio muestral de un experimento $\epsilon$ que consiste en observar las decisiones del raton. Estas corresponden corresponden a elegir izquierda-izquierda, elegir izquierda-derecha y elegir derecha respectivamente. Si definimos una variable aleatoria X tal que:
    
    \[X(s)= \left\{ \begin{array}{lcc}
             2 &   si  & x \ = \  "ii" \\
             \\ 5 &  si & x \ = \ "id" \\
             \\ 3 &  si  & x \ = \ "d"
             \end{array}
   \right.\]
   
   Ahora definimos una variable aleatoria Y = \{numero de repeticiones hasta que el evento \{2\} ocurra\} y observamos que Y se puede aproximar con la distribucion geometrica. Sabemos que $P(\{2\})=P(ii \cap i)=P(ii | i) P(i)= \frac{1}{3} \frac{1}{2} = \frac{1}{6}$, por lo que E(Y) = $\frac{2}{\frac{1}{6}} = 12$. Luego definimos una variable aleatoria Z = \{numero de repeticiones hasta que el evento \{3\} ocurra\} y observamos que Z se puede aproximar con la distribucion geometrica. Sabemos que $P(\{3\})= \frac{1}{2}$, por lo que E(Y) = $\frac{3}{\frac{1}{2}} = 6$. Luego definimos una variable aleatoria W = \{numero de repeticiones hasta que el evento \{5\} ocurra\} y observamos que W se puede aproximar con la distribucion geometrica. Sabemos que $P(\{5\})=P(id \cap i)=P(id | i) P(i)= \frac{2}{3} \frac{1}{2} = \frac{2}{6}$, por lo que E(Y) = $\frac{5}{\frac{1}{3}} = 15$. Por lo tanto p(\{Salga\}) tiene un peso en minutos de E(Y) = 12, mientras que 1-p tiene un peso en minutos de E(Z+W) = E(Z) + E(W) = 21. Por lo que el tiempo esperado para que la rata salga del laberinto es de $12 1/3 1/2 + 21 5/6 = 19,5$ minutos.
\end{itemize}

\vspace{1cm}
\newpage
\section{Ejercicio 5}
\vspace{0,5cm}

\begin{itemize}
    \item [a)] La matriz de transicion P es no-regular. Esta cadena de Markov presenta 4 clases de comunicacion (una por cada estado). El estado M es absorbente, por lo cual la cadena de Markov es absorbente, los demas estados son de transicion.
    
    \item [b)] Para n=10 pasos obtenemos la matriz $P^n$, donde $P^n_{ij}$ representa la probabilidad de llegar a j desde i en n pasos.
    
        \begin{equation}
            P^{10}\simeq\left(\begin{matrix}
                        0.99004 & 0.00969 & 0.000214 & 0.00005069 \\
                        0 & 0.94159 & 0.04078 & 0.0176248 \\
                        0 & 0 & 0.425037 & 0.5749629 \\
                        0 & 0 & 0 & 1
                        \end{matrix}\right)
        \end{equation}
        
        Partiendo desde un estado luego de 10 unidades de observacion en la evolucion de esta persona podemos observar:
        
\end{itemize}
\begin{itemize}
      \item ["Suceptible".] 
      
            \subitem  {\bf Suceptible.}  Partiendo desde suceptible hay una probabilidad de que el sujeto siga en su estado de suceptibilidad de 0.99004, luego de 10 unidades de observacion.
        
            \subitem  {\bf VIH.}  Partiendo desde suceptible hay una probabilidad de que el sujeto contraiga VIH de 0.00969, luego de 10 unidades de observacion.
            
            \subitem  {\bf SIDA.}  Partiendo desde suceptible hay una probabilidad de que el sujeto contraiga SIDA de 0.000214, luego de 10 unidades de observacion.
            
            \subitem  {\bf Muerto.}  Partiendo desde suceptible hay una probabilidad de que el sujeto muera a causa de la enfermedad de 0.00005069, luego de 10 unidades de observacion.
\end{itemize}

Por lo tanto si el sujeto es suceptible, en 10 unidades de observacion, es altamente probable que se mantenga en esta condicion.

\begin{itemize}
      \item ["VIH".] 
      
            \subitem  {\bf Suceptible.}  Partiendo desde VIH no hay una probabilidad de que el sujeto vuelva al estado "suceptible" , luego de 10 unidades de observacion.
        
            \subitem  {\bf VIH.}  Partiendo desde VIH hay una probabilidad de que el sujeto se mantenga en su condicion de 0.94159, luego de 10 unidades de observacion.
            
            \subitem  {\bf SIDA.}  Partiendo desde VIH hay una probabilidad de que el sujeto contraiga SIDA de 0.04078, luego de 10 unidades de observacion.
            
            \subitem  {\bf Muerto.}  Partiendo desde VIH hay una probabilidad de que el sujeto muera a causa de la enfermedad de 0.0176248, luego de 10 unidades de observacion.
\end{itemize}

Por lo tanto si el sujeto esta diagnosticado con VIH, tiene altas probabilidades de mantener su condicion y no puede librarse de su enfermedad.

\begin{itemize}
      \item ["SIDA".] 
      
            \subitem  {\bf Suceptible.}  Partiendo desde SIDA no hay una probabilidad de que el sujeto vuelva al estado de "suceptibilidad" , luego de 10 unidades de observacion.
        
            \subitem  {\bf Suceptible.}  Partiendo desde SIDA no hay una probabilidad de que el sujeto vuelva al estado de "VIH" , luego de 10 unidades de observacion.
            
            \subitem  {\bf SIDA.}  Partiendo desde SIDA hay una probabilidad de que el sujeto se mantenga en su condicion de 0.425037, luego de 10 unidades de observacion.
            
            \subitem  {\bf Muerto.}  Partiendo desde SIDA hay una probabilidad de que el sujeto muera a causa de la enfermedad de 0.5749629, luego de 10 unidades de observacion.
\end{itemize}
Por lo tanto si el sujeto esta diagnosticado con SIDA, tiene un $57\%$ de morir luego de 10 unidades de observacion. No puede volver a la condicion de VIH, ni a la de suceptible, mientras que se puede mantener con SIDA con una probabilidad de $0.425037\%$ .
\vspace{0,5cm}

Por otro lado si esta muerto... bueno, digamos que es el estado absorbente por excelencia.


\newpage

\begin{itemize}
    \item [c)] Sabemos que
\end{itemize}  

\begin{equation}
            Q=\left(\begin{matrix}
                        0.999 & 0.001 & 0\\
                        0 & 0.994 & 0.006 \\
                        0 & 0 & 0.918 \\
                        
                        \end{matrix}\right)
        \end{equation}

Y por lo tanto,
\begin{equation}
    F = (I - Q)^{-1}= \left(\begin{matrix}
1000 & \frac{500}{3} & \frac{500}{41} \\
0 & \frac{500}{3} & \frac{500}{41} \\
0 & 0 & \frac{500}{41}
\end{matrix}\right)    
\end{equation}
Donde F es la matriz fundamental, en la cual $F_ij$
es el numero esperado de visitas a j dado que la cadena comienza en i. Por lo tanto, si iniciamos en el estado

\begin{itemize}
    \item ["Suceptible"] el numero esperado de pasos para llegar al estado de muerte a causa de la enfermedad es de 1178.862
    
    \item ["VIH"] el numero esperado de pasos para llegar al estado de muerte a causa de la enfermedad es de 178.862
    
    \item ["SIDA"] el numero esperado de pasos para llegar al estado de muerte a causa de la enfermedad es de 12.19
\end{itemize}

Cada uno de los resultados obtenidos de acuerdo al estado desde el que se comienza a contabilizar, es el promedio de unidades de observacion para que la persona llegue al estado de muerte.

\begin{itemize}
    \item [d)] COMPLETAR LO TENGO EN CUADERNILLO
\end{itemize}

\newpage

\section{Ejercicio 6}
\vspace{1cm}

\begin{itemize}
    \item [a)] 
    \begin{equation}
        P=\left(\begin{matrix}
0 & 0 & 0 & 0 & \frac{1}{2} & \frac{1}{2} & 0 \\
\frac{1}{3} & 0 & \frac{1}{3} & 0 & 0 & \frac{1}{3} & 0 \\
0 & 0 & 0 & \frac{1}{2} & 0 & \frac{1}{2} & 0 \\
0 & 0 & 0 & 0 & 0 & 1 & 0 \\
\frac{1}{4} & 0 & 0 & \frac{1}{4} & 0 & \frac{1}{4} & \frac{1}{4} \\
\frac{1}{2} & \frac{1}{2} & 0 & 0 & 0 & 0 & 0 \\
\frac{1}{7} & \frac{1}{7} & \frac{1}{7} & \frac{1}{7} & \frac{1}{7} & \frac{1}{7} & \frac{1}{7}
\end{matrix}\right)
    \end{equation}
    \item [b)] Simulacion
    \item [c)] Obtuve el siguiente vector de frecuencias relativas : [0.25, 0.16, 0.04, 0.06, 0.10, 0.34, 0.05]. Por lo cual con n=100 suponemos que el rango de las paginas a,b,c...,g corresponden con las posiciones desde 1 a 7 del vector obtenido por medio de la simulacion.
\end{itemize}
\vspace{1cm}

\section{Ejercicio 7}
\vspace{0,5cm}

\begin{itemize}
    \item [a)] Sea $X_t$ el numero de llamads que recibe Juan durante un intervalo de tiempo t. Sabemos que $X_t$ tiene una distribucion de Poisson con parametro $\lamda = 10 textos/hora$. Por lo tanto, $P()$
\end{itemize}

\newpage
\section{Ejercicio 8}
\vspace{1cm}

\begin{itemize}
    \item [a)] Dada la distribucion inicial $\pi_0$, y la matriz de transicion P, luego de dos semanas nos encontramos con la siguiente probabilidad de ataques a los puertos:
    
    \[\pi_0P^2= \left(\begin{matrix}
0 & \frac{1}{8} & \frac{1}{2} & \frac{1}{8} & \frac{1}{4}
\end{matrix}\right)\]
\end{itemize}

\[\pi_0=\left(\begin{matrix}
0 & 0 & 0 & 0 & 1
\end{matrix}\right)\]

\[P=\left(\begin{matrix}
0 & 0 & 0 & 0 & 1 \\
0 & \frac{8}{13} & \frac{3}{13} & \frac{1}{13} & \frac{1}{13} \\
\frac{1}{16} & \frac{3}{16} & \frac{3}{8} & \frac{1}{4} & \frac{1}{8} \\
0 & \frac{1}{11} & \frac{4}{11} & \frac{5}{11} & \frac{1}{11} \\
0 & \frac{1}{8} & \frac{1}{2} & \frac{1}{8} & \frac{1}{4}
\end{matrix}\right)\]

Los puertos con menos probabilidad de ser atacados son el 135 y 445, mientras que el que tiene mas probabilidad de ser atacado es el 139. Se puede observar que el puerto 80 no tiene posibilidad de ser atacado.
\end{document}

